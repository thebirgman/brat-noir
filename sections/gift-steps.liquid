{% style %}
  .gift-steps {
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }

  .gift-steps__container {
    max-width: {{ section.settings.max_width }}px;
    margin: 0 auto;
    background: {{ section.settings.background }};
    border-radius: 24px;
    padding: 48px 32px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
  }

  .gift-steps__heading {
    text-align: center;
    margin-bottom: 48px;
  }

  .gift-steps__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 32px;
    text-align: center;
  }

  .gift-step img {
    width: {{ section.settings.image_size }}px;
    max-width: 100%;
    margin: 0 auto 24px;
    display: block;
  }

  .gift-step h3 {
    margin-bottom: 8px;
  }

  .gift-step p {
    margin: 0;
  }

  /* Mobile optimizations */
  @media (max-width: 768px) {
    .gift-steps__container {
      padding: 32px 20px;
      border-radius: 20px;
    }

    .gift-steps__heading {
      margin-bottom: 32px;
    }

    .gift-steps__grid {
      grid-template-columns: 1fr;
      gap: 40px;
    }

    .gift-step img {
      width: calc({{ section.settings.image_size }}px * 0.8);
      margin-bottom: 20px;
    }
  }

  @media (max-width: 480px) {
    .gift-step img {
      width: calc({{ section.settings.image_size }}px * 0.7);
    }
  }
{% endstyle %}

<section class="gift-steps">
  <div class="gift-steps__container">
    {% if section.settings.heading != blank %}
      <div class="gift-steps__heading">
        <h2>{{ section.settings.heading }}</h2>
      </div>
    {% endif %}

    <div class="gift-steps__grid">
      {% for block in section.blocks %}
        <div class="gift-step" {{ block.shopify_attributes }}>
          {% if block.settings.image %}
            <img
              src="{{ block.settings.image | image_url: width: 400 }}"
              alt="{{ block.settings.title | escape }}"
              loading="lazy"
            >
          {% endif %}

          {% if block.settings.title != blank %}
            <h3>{{ block.settings.title }}</h3>
          {% endif %}

          {% if block.settings.text != blank %}
            <p>{{ block.settings.text }}</p>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Gift Steps",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Gift Giving, Elevated."
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Section width (px)",
      "min": 800,
      "max": 1600,
      "step": 50,
      "default": 1200
    },
    {
      "type": "range",
      "id": "image_size",
      "label": "Step image size (px)",
      "min": 60,
      "max": 240,
      "step": 10,
      "default": 140
    },
    {
      "type": "color_background",
      "id": "background",
      "label": "Background",
      "default": "linear-gradient(135deg, #f3e8ff, #fce7f3)"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "min": 0,
      "max": 200,
      "step": 8,
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "min": 0,
      "max": 200,
      "step": 8,
      "default": 80
    }
  ],
  "blocks": [
    {
      "type": "step",
      "name": "Step",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Step 1"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Step description"
        }
      ]
    }
  ],
  "max_blocks": 6,
  "presets": [
    {
      "name": "Gift Steps",
      "blocks": [
        { "type": "step" },
        { "type": "step" },
        { "type": "step" }
      ]
    }
  ]
}
{% endschema %}
