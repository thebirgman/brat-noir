<section class="no-stress">
  <div class="no-stress__container">
    {% if section.settings.heading != blank %}
      <h2 class="no-stress__heading">
        {{ section.settings.heading }}
      </h2>
    {% endif %}

    <div class="no-stress__grid">

      {% for block in section.blocks %}
        <div
          class="
            no-stress__card
            {% if block.settings.full_width %}no-stress__card--full{% endif %}
          "
          {{ block.shopify_attributes }}
        >
          {% if block.settings.image != blank %}
            <picture>
              {% if block.settings.mobile_image != blank %}
                <source
                  media="(max-width: 768px)"
                  srcset="{{ block.settings.mobile_image | image_url: width: 900 }}"
                >
              {% endif %}

              <img
                src="{{ block.settings.image | image_url: width: 1600 }}"
                alt="{{ block.settings.title | escape }}"
                loading="lazy"
              >
            </picture>
          {% endif %}

          <div class="no-stress__overlay">
            <strong>{{ block.settings.title }}</strong>
            <p>{{ block.settings.text }}</p>
          </div>
        </div>
      {% endfor %}

    </div>
  </div>
</section>

<style>
.no-stress {
  padding: 60px 20px;
  background: {{ section.settings.background }};
}

.no-stress__container {
  max-width: {{ section.settings.max_width }}px;
  margin: 0 auto;
}

.no-stress__heading {
  text-align: center;
  font-size: 32px;
  margin-bottom: 40px !important;
}

.no-stress__grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
}

.no-stress__card {
  position: relative;
  overflow: hidden;
  border-radius: 20px;
}

.no-stress__card--full {
  grid-column: span 2;
}

.no-stress__card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.no-stress__overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 24px;
  color: #fff;
  background: linear-gradient(
    to top,
    rgba(0,0,0,0.55),
    rgba(0,0,0,0)
  );
}

.no-stress__overlay strong {
  display: block;
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 6px;
}

.no-stress__overlay p {
  font-size: 14px;
  margin: 0;
}

/* MOBILE */
@media (max-width: 768px) {
  .no-stress__grid {
    grid-template-columns: 1fr;
  }

  .no-stress__card--full {
    grid-column: span 1;
  }

  .no-stress__heading {
    font-size: 28px;
    margin-bottom: 31px !important;
  }

  /* Limit paragraph width on mobile only */
  .no-stress__overlay p {
    max-width: 200px;
  }
}

</style>

{% schema %}
{
  "name": "No Stress Promise",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "The No-Stress Promise"
    },
    {
      "type": "range",
      "id": "max_width",
      "label": "Max width",
      "min": 800,
      "max": 1600,
      "step": 50,
      "default": 1200,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "background",
      "label": "Background color",
      "default": "#F4F0FF"
    }
  ],
  "blocks": [
    {
      "type": "card",
      "name": "Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Desktop image"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "Mobile image (optional)"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "No Traps:"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Text",
          "default": "We email you 3 days before your box ships."
        },
        {
          "type": "checkbox",
          "id": "full_width",
          "label": "Full width (desktop)",
          "default": false
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "No Stress Promise",
      "blocks": [
        { "type": "card" },
        { "type": "card" },
        {
          "type": "card",
          "settings": {
            "full_width": true
          }
        }
      ]
    }
  ]
}
{% endschema %}
